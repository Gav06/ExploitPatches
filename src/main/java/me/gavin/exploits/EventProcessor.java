package me.gavin.exploits;

import me.gavin.exploits.event.listeners.TimerUpdateEvent;

import java.sql.Time;
import java.util.Timer;
import java.util.TimerTask;

public class EventProcessor {

    public Timer timer;
    public Timer witherTimer;

    public EventProcessor() {
        doSandTimer();
    }

    public void stopTimers() {
        timer.purge();
        timer.cancel();

        witherTimer.purge();
        witherTimer.cancel();
    }

    // timer event for things like sand removal
    private void doSandTimer() {
        timer = new Timer();
        timer.scheduleAtFixedRate(new TimerTask() {
                                      @Override
                                      public void run() {
                                          Main.EVENT_BUS.post(new TimerUpdateEvent());
                                      }
                                  },
                (long) Main.get().config.getDouble("AntiFallingSand.Clear-Delay") * 1000,
                (long) Main.get().config.getDouble("AntiFallingSand.Clear-Delay") * 1000);
    }

    private void doWitherTimer() {
        witherTimer = new Timer();
        witherTimer.scheduleAtFixedRate(new TimerTask() {
                                      @Override
                                      public void run() {
                                          Main.EVENT_BUS.post(new TimerUpdateEvent.Wither());
                                      }
                                  },
                (long) Main.get().config.getDouble("AntiFallingSand.Clear-Delay") * 1000,
                (long) Main.get().config.getDouble("AntiFallingSand.Clear-Delay") * 1000);
    }
}
