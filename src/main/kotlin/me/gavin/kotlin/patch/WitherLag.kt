package me.gavin.kotlin.patch

import me.gavin.exploits.Main
import me.gavin.exploits.event.EventListener
import me.gavin.exploits.event.listeners.TimerUpdateEvent
import org.bukkit.Bukkit
import org.bukkit.entity.EntityType

class WitherLag {

    // TODO
    // fix this shit so it isn't as laggy
    @EventListener
    fun onTimer(event: TimerUpdateEvent.Wither) {
        if (Main.get().config.getBoolean("AntiWither.Enabled")) {
            for (world in Bukkit.getWorlds()) {
                for (chunk in world.loadedChunks) {
                    var witherCount = 0

                    for (entity in chunk.entities) {
                        if (entity.type == EntityType.WITHER)
                            witherCount++

                        if (witherCount > Main.get().config.getInt("AntiWither.Wither-Limit"))
                            entity.remove()
                    }
                }
            }
        }
    }
}