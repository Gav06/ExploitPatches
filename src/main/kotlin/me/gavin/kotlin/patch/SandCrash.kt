package me.gavin.kotlin.patch

import me.gavin.exploits.Main
import me.gavin.exploits.Utils
import me.gavin.exploits.event.EventListener
import me.gavin.exploits.event.listeners.TimerUpdateEvent
import org.bukkit.entity.FallingBlock

class SandCrash {

    @EventListener
    fun onTimer(event: TimerUpdateEvent) {
        if (
            Main.get().config.getBoolean("AntiFallingSand.Enabled")
            && Main.get().config.getDouble("Activate-Tps") < Utils.getTPS()) {
            for (world in Main.get().server.worlds) {
                for (entity in world.entities) {
                    if (entity is FallingBlock)
                        entity.remove()
                }
            }
        }
    }
}