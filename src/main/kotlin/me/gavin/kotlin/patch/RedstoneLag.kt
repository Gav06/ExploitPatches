package me.gavin.kotlin.patch

import me.gavin.exploits.Main
import me.gavin.exploits.Utils
import org.bukkit.Material
import org.bukkit.event.EventHandler
import org.bukkit.event.Listener
import org.bukkit.event.block.BlockRedstoneEvent

class RedstoneLag : Listener {

    @EventHandler
    fun onRedstone(event: BlockRedstoneEvent) {
        if (Main.get().config.getBoolean("AntiRedstone.Enabled")) {
            if (Utils.getTPS() < Main.get().config.getDouble("AntiRedstone.Disable-Tps")) {
                // to prevent trapped chests from not working
                if (event.block.type != Material.TRAPPED_CHEST) {
                    event.newCurrent = 0
                }
            }
        }
    }
}